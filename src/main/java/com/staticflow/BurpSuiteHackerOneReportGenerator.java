package main.java.com.staticflow;

import burp.api.montoya.BurpExtension;
import burp.api.montoya.MontoyaApi;

/**
 * This extension adds a custom right click context menu in two locations:<br>
 *  1. Repeater Request Tabs <br>
 *  2. Issue Activity List Items (For professional only) <br>
 *  When this context menu is selected, the contents of: <br>
 *  1. Repeater Request+Response data <br>
 *  2. Issue Name + Issue PoC Request + Issue PoC Response <br>
 *  are combined and sent to the {@value ContextMenuActionListener#REPORT_SUBMISSION_URL} endpoint
 *  to generate a draft vulnerability submission. For more information on the details of how this is
 *  performed, see {@link CustomContextMenuProvider}
 */
public class BurpSuiteHackerOneReportGenerator implements BurpExtension {

    /**
     * Initialize this extension
     * @param montoyaApi The Burp Suite provided callback and helper methods
     */
    @Override
    public void initialize(MontoyaApi montoyaApi) {
        montoyaApi.extension().setName("HackerOneVulnerabilityDrafter");
        //Save a reference to the Burp Suite supplied callbacks and helper methods to the internal singleton state object
        ExtensionState.getInstance().setCallbacks(montoyaApi);
        //Register this extension's custom context menu handler
        montoyaApi.userInterface().registerContextMenuItemsProvider(ExtensionState.getInstance().getCustomContextMenuProvider());
    }
}